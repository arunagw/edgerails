<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Edge Rails.info :: Dynamic Scope Methods</title>
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <link href="/atom.xml" rel="alternate" title="Edge Rails.info" type="application/atom+xml" />
    <script type="text/javascript">
      //<![CDATA[
        var twitter_user = ""
        var show_replies = false;
        var tweet_count = 3;
      //]]>
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/mootools/1.2.4/mootools-yui-compressed.js" type="text/javascript"></script>
    <script src="/javascripts/mootools-1.2.4.2-more.js" type="text/javascript"></script>
    <script src="/javascripts/octopress.js" type="text/javascript"></script>
    <script src="/javascripts/twitter.js" type="text/javascript"></script>
  </head>
  <body id="">
    <div id="header">
      <div class="page_width">
        <a class="title" href="/">Edge Rails.info</a>
        <div id="search">
          <form action="http://www.google.com/cse" id="cse-search-box">
            <input name="cx" type="hidden" value="" />
            <input name="ie" type="hidden" value="UTF-8" />
            <input id="q" name="q" type="text" />
          </form>
        </div>
      </div>
    </div>
    <div id="nav">
      <div class="page_width">
        <ul>
          <li class="alpha">
            <a href="/">Blog</a>
          </li>
          <li class="omega">
            <a href="/about.html">About</a>
          </li>
          <li class="subscribe">
            <a href="/atom.xml">Subscribe</a>
          </li>
        </ul>
      </div>
    </div>
    <div id="page">
      <div class="page_width">
        <div id="main">
          <div class="blog">
            <div class="article">
              <h2>Dynamic Scope Methods</h2>
              &#x000A;<hr/>&#x000A;<p><em>This feature is scheduled for: Rails v2.3/3.0</em><br />&#x000A;<hr/></p>&#x000A;<p>For quite some time now you&#8217;ve been able to perform simple queries using dynamic <code>find_all_by_xx_and_yy</code> methods:</p>&#x000A;<div class="highlight"><pre><span class="no">Article</span><span class="o">.</span><span class="n">find_by_published_and_user_id</span><span class="p">(</span><span class="kp">true</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>&#x000A;  <span class="c1">#=&gt; &quot;SELECT * FROM articles WHERE published = 1 AND user_id = 1&quot;</span>&#x000A;</pre>&#x000A;</div>&#x000A;<p>These dynamic finders provide an easy way to quickly encapsulate non-reused query conditions (for commonly used query logic you should consider using <a href="/articles/2008/3/24/what-s-new-in-edge-rails-has-finder-functionality">named scopes</a>).  The downside, however, is that you can&#8217;t chain query conditions when using these dynamic finders.</p>&#x000A;<p>With the recent addition of <a href="http://github.com/rails/rails/commit/66ee5890c5f21995b7fe0c486547f1287afe2b55">dynamic scopes</a>, however, you now have a way to both quickly specify query logic and chain further conditions.  The naming works in the same manner as dynamic finders and the chaining works in the same fashion as conventional named scopes:</p>&#x000A;<div class="highlight"><pre><span class="no">Article</span><span class="o">.</span><span class="n">scoped_by_published_and_user_id</span><span class="p">(</span><span class="kp">true</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="ss">:all</span><span class="p">,</span> <span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)</span>&#x000A;  <span class="c1">#=&gt; &quot;SELECT * FROM articles WHERE published = 1 AND user_id = 1 LIMIT 5&quot;</span>&#x000A;</pre>&#x000A;</div>&#x000A;<p>Note how you can hang further chainable query methods off the dynamic scope here?  You could also have preceded the dynamic scope with another scope, or even another dynamic scope:</p>&#x000A;<div class="highlight"><pre><span class="no">Article</span><span class="o">.</span><span class="n">scoped_by_published</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span><span class="o">.</span><span class="n">scoped_by_user_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>&#x000A;  <span class="c1">#=&gt; &quot;SELECT * FROM articles WHERE published = 1 AND user_id = 1&quot;</span>&#x000A;</pre>&#x000A;</div>&#x000A;<p>This is really just another tool to put in your toolbox based on the powerful named_scope functionality of ActiveRecord.</p>
            </div>
            <p class="pubdate">
              Published:
              29 Dec, 2008
            </p>
            <p class="related_articles">
              <h2>Related Articles</h2>
              <ul></ul>
              <li>
                <a href="/articles/what-s-new-in-edge-rails/2008/11/18/what-s-new-in-edge-rails-default-scoping">Default Scoping</a>
              </li>
              <li>
                <a href="/articles/what-s-new-in-edge-rails/2009/02/01/what-s-new-in-edge-rails-nested-attributes">Nested Object Forms</a>
              </li>
              <li>
                <a href="/articles/what-s-new-in-edge-rails/2008/03/24/what-s-new-in-edge-rails-has-finder-functionality">Has Finder Functionality</a>
              </li>
            </p>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
              //<![CDATA[
                var disqus_url = "http://rwdaigle.github.com/edgerails/articles/what-s-new-in-edge-rails/2008/12/29/what-s-new-in-edge-rails-dynamic-scope-methods";
              //]]>
            </script>
            <noscript>
              <a href="http://edgerails.disqus.com/?url=ref">View the discussion thread</a>
            </noscript>
            <script src="http://disqus.com/forums/edgerails/embed.js" type="text/javascript"></script>
          </div>
        </div>
        <div id="sidebar">
          <h4>Twitter <a class="small" href="http://twitter.com/">@</a></h4>
          <div id="twitter">
            <ul id="twitter_status">
              Status updating...
            </ul>
          </div>
          <h4>My Delicious <a class="small" href="http://delicious.com/">more &rarr;</a></h4>
          <div id="delicious">
            <script src="http://feeds.delicious.com/v2/js/?title=&amp;count=3&amp;sort=date&amp;extended" type="text/javascript"></script>
          </div>
        </div>
      </div>
    </div>
    <div id="footer">
      <div class="page_width">
        Copyright &copy; 2009 - Edge Rails.info -
        <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
      </div>
    </div>
    <!-- /Disqus Comments code -->
    <script type="text/javascript">
      //<![CDATA[
        (function() {
            var links = document.getElementsByTagName('a');
            var query = '?';
            for(var i = 0; i < links.length; i++) {
              if(links[i].href.indexOf('#disqus_thread') >= 0) {
                query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
              }
            }
            document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/edgerails/get_num_replies.js' + query + '"></' + 'script>');
          })();
      //]]>
    </script>
    <!-- /Google Analytics code -->
    <script type="text/javascript">
      //<![CDATA[
        try {
        var pageTracker = _gat._getTracker("");
        pageTracker._trackPageview();
        } catch(err) {}
      //]]>
    </script>
  </body>
</html>
